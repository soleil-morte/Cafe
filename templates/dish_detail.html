{% extends "base.html" %}

{% block title %}{{ dish.name }} - –ö–∞—Ñ–µ –£—é—Ç–Ω–æ–µ{% endblock %}

{% block content %}
<div class="container">
    <div class="page-header">
        <h1>{{ dish.name }}</h1>
        <a href="/menu/" class="btn">‚Üê –ù–∞–∑–∞–¥ –∫ –º–µ–Ω—é</a>
    </div>

    <div class="dish-detail">
        <div class="dish-header">
            {% if dish.image %}
            <div class="dish-image-large">
                <img src="{{ dish.image.url }}" alt="{{ dish.name }}">
            </div>
            {% endif %}

            <div class="dish-info">
                <h3>üìù –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                <p><strong>–¶–µ–Ω–∞:</strong> {{ dish.price }} —Å—É–º</p>
                <p><strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong> {{ dish.description|default:"–ù–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è" }}</p>
            </div>
        </div>

        <div class="dish-cost">
            <h3>üí∞ –†–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏</h3>
            <p><strong>–°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å:</strong> {{ cost|floatformat:2 }} —Å—É–º</p>
            <p><strong>–ü—Ä–∏–±—ã–ª—å —Å –ø–æ—Ä—Ü–∏–∏:</strong> {{ profit|floatformat:2 }} —Å—É–º</p>
            <p><strong>–ù–∞—Ü–µ–Ω–∫–∞:</strong> 
                {% if cost > 0 %}
                {{ dish.price|floatformat:2 }} / {{ cost|floatformat:2 }} = {{ dish_price_ratio|floatformat:1 }}x
                {% else %}
                –ù–µ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–æ
                {% endif %}
            </p>
        </div>

        <div class="ingredients-list">
            <h3>ü•ò –ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã (–Ω–∞ –æ–¥–Ω—É –ø–æ—Ä—Ü–∏—é)</h3>
            {% for item in ingredients_with_cost %}
            <div class="ingredient-item">
                <div class="ingredient-name">{{ item.ingredient.product.name }}</div>
                <div class="ingredient-quantity">
                    {{ item.ingredient.quantity }} {{ item.ingredient.get_unit_display }}
                    {% if item.ingredient.unit != item.ingredient.product.unit %}
                    <br><small style="color: #666;">
                        = {{ item.converted_quantity|floatformat:3 }} {{ item.ingredient.product.get_unit_display }} –Ω–∞ —Å–∫–ª–∞–¥–µ
                    </small>
                    {% endif %}
                </div>
                <div class="ingredient-cost">
                    {{ item.converted_quantity|floatformat:3 }} √ó {{ item.ingredient.product.purchase_price }} =
                    {{ item.cost|floatformat:2 }} —Å—É–º.
                </div>
            </div>
            {% empty %}
            <p>–ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã</p>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}