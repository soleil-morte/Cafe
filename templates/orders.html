{% extends 'base.html' %}

{% block title %}Buyurtmalar - Restaurant Pro{% endblock %}
{% block page_title %}Buyurtmalar{% endblock %}

{% block content %}
<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
    <h1>Barcha Buyurtmalar</h1>
    <a href="{% url 'order_create' %}" class="btn btn-primary">+ Yangi Buyurtma</a>
</div>

<div class="table">
    <div class="table-header">
        <div>Buyurtma</div>
        <div>Mijoz</div>
        <div>Tur</div>
        <div>Summa</div>
        <div>Holat</div>
        <div>Amallar</div>
    </div>
    
    {% for order in orders %}
    <div class="table-row">
        <div>
            <strong>#{{ order.id }}</strong>
            <div style="font-size: 0.8rem; color: #666;">{{ order.created_at|date:"H:i d/m/Y" }}</div>
        </div>
        <div>
            {% if order.customer_name %}
                {{ order.customer_name }}
                {% if order.phone_number %}<br><small>{{ order.phone_number }}</small>{% endif %}
            {% else %}
                Noma'lum
            {% endif %}
        </div>
        <div>{{ order.get_order_type_display }}</div>
        <div><strong>{{ order.total_price }} so'm</strong></div>
        <div>
            <span style="background: {% if order.is_completed %}var(--success){% else %}var(--warning){% endif %}; 
                      color: white; padding: 4px 12px; border-radius: 20px; font-size: 0.8rem;">
                {% if order.is_completed %}âœ… Bajarildi{% else %}ğŸ”„ Jarayonda{% endif %}
            </span>
        </div>
        <div class="action-buttons">
            <a href="{% url 'table_order_by_id' order.id %}" class="btn" style="background: var(--info); color: white; padding: 8px 12px; font-size: 0.9rem;">ğŸ‘ï¸</a>
            {% if not order.is_completed %}
            <a href="{% url 'order_delete' order.id %}" class="btn" style="background: var(--danger); color: white; padding: 8px 12px; font-size: 0.9rem;" onclick="return confirm('Buyurtmani o\'chirmoqchimisiz?')">ğŸ—‘ï¸</a>
            {% endif %}
        </div>
    </div>
    {% empty %}
    <div class="table-row">
        <div colspan="6" style="text-align: center; padding: 40px; color: #666;">
            Hozircha buyurtmalar mavjud emas
        </div>
    </div>
    {% endfor %}
</div>
{% endblock %}